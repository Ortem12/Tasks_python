import pandas as pd

# Данные о ежемесячных доходах
data = {
    '2019-01-31': 100000, '2019-02-28': 120000, '2019-03-31': 150000, '2019-04-30': 80000,
    '2019-05-31': 200000, '2019-06-30': 250000, '2019-07-31': 180000, '2019-08-31': 300000,
    '2019-09-30': 280000, '2019-10-31': 320000, '2019-11-30': 350000, '2019-12-31': 400000,
    '2020-01-31': 180000, '2020-02-29': 200000, '2020-03-31': 220000, '2020-04-30': 240000,
    '2020-05-31': 260000, '2020-06-30': 280000, '2020-07-31': 300000, '2020-08-31': 320000,
    '2020-09-30': 340000, '2020-10-31': 360000, '2020-11-30': 380000, '2020-12-31': 400000,
    '2021-01-31': 150000, '2021-02-28': 300000, '2021-03-31': 250000, '2021-04-30': 280000,
    '2021-05-31': 320000, '2021-06-30': 350000, '2021-07-31': 380000, '2021-08-31': 400000,
    '2021-09-30': 420000, '2021-10-31': 440000, '2021-11-30': 470000, '2021-12-31': 500000,
    '2022-01-31': 200000, '2022-02-28': 220000, '2022-03-31': 240000, '2022-04-30': 260000,
    '2022-05-31': 280000, '2022-06-30': 300000, '2022-07-31': 320000, '2022-08-31': 340000,
    '2022-09-30': 360000, '2022-10-31': 380000, '2022-11-30': 400000, '2022-12-31': 420000,
    '2023-01-31': 150000, '2023-02-28': 160000, '2023-03-31': 180000, '2023-04-30': 200000,
    '2023-05-31': 220000, '2023-06-30': 240000, '2023-07-31': 260000, '2023-08-31': 280000,
    '2023-09-30': 300000, '2023-10-31': 320000, '2023-11-30': 340000, '2023-12-31': 360000
}

# Преобразование данных в DataFrame
df = pd.DataFrame(list(data.items()), columns=['Дата', 'Доход'])
df['Дата'] = pd.to_datetime(df['Дата'])  # Преобразование столбца 'Дата' в формат datetime
df['Год'] = df['Дата'].dt.year  # Добавление столбца с годом

# Годовая доходность
yearly_income = df.groupby('Год')['Доход'].sum()

# Средняя ежемесячная доходность по каждому году
monthly_avg_income = df.groupby('Год')['Доход'].mean()

# Год с наибольшей и наименьшей доходностью
max_year = yearly_income.idxmax()
min_year = yearly_income.idxmin()

# Вывод результатов
print("Годовая доходность:")
for year, income in yearly_income.items():
    print(f"{year}: {income}")

print("\nСредняя ежемесячная доходность по каждому году:")
for year, avg_income in monthly_avg_income.items():
    print(f"{year}: {avg_income:.2f}")

print(f"\nГод с наибольшей доходностью: {max_year}")
print(f"Год с наименьшей доходностью: {min_year}")